{"version":3,"file":"BasicSelect-95dcdf6f.js","sources":["../../../../src/components/ui/form/BasicSelect.vue"],"sourcesContent":["<script>\nimport {\n  ref,\n  reactive,\n  computed,\n  onMounted,\n  nextTick,\n  inject,\n  h,\n  useCssModule,\n} from 'vue';\nimport VueSelect from 'vue-select';\nimport { createPopper } from '@popperjs/core';\n\nimport IconDropdown from '@/assets/images/icon/dropdown.svg?component';\n\nconst defaultClassNames = () => ({\n  wrap: '',\n  list: '',\n});\n\nexport default {\n  components: {\n    VueSelect,\n  },\n  inheritAttrs: false,\n  props: {\n    classNames: {\n      Type: Object,\n      default() {\n        return defaultClassNames();\n      },\n    },\n    filterable: {\n      Type: Boolean,\n      default: false,\n    },\n    searchable: {\n      Type: Boolean,\n      default: false,\n    },\n    clearable: {\n      Type: Boolean,\n      default: false,\n    },\n    reduce: {\n      type: Function,\n      default: (option) => option.value,\n    },\n    onSelected: {\n      type: Function,\n      default: () => {},\n    },\n    onUpdate: {\n      type: Function,\n      default: () => {},\n    },\n    defaultValue: {\n      Type: String,\n      default: null,\n    },\n    modelValue: {\n      Type: String,\n    },\n  },\n  setup(props, { emit }) {\n    const $style = useCssModule();\n\n    const state = reactive({\n      placement: 'bottom-start',\n      value: '',\n    });\n\n    const formListItem = inject('formListItem', {});\n\n    const select = ref(null);\n\n    const customClassNames = computed(() => {\n      const { classNames } = props;\n      return Object.assign(defaultClassNames(), classNames);\n    });\n\n    const vmVal = computed({\n      get() {\n        onUpdate(props.modelValue);\n        return props.modelValue;\n      },\n      set(value) {\n        emit('update:modelValue', value);\n      },\n    });\n\n    const withPopper = (dropdownList, component, { width }) => {\n      dropdownList.style.width = width;\n\n      const popper = createPopper(component.$refs.toggle, dropdownList, {\n        placement: state.placement,\n        modifiers: [\n          {\n            name: 'offset',\n            options: {\n              offset: [0, 0],\n            },\n          },\n          {\n            name: 'toggleClass',\n            enabled: true,\n            phase: 'write',\n            fn({ state }) {\n              const { classNames } = props;\n              const customClassNames = Object.assign(\n                defaultClassNames(),\n                classNames\n              );\n\n              dropdownList.classList.add($style['select__list']);\n\n              if (customClassNames.list.length) {\n                dropdownList.classList.add(customClassNames.list);\n              }\n\n              dropdownList.classList.toggle(\n                'drop-up',\n                state.placement === 'top-start'\n              );\n\n              component.$el.classList.toggle(\n                'drop-up',\n                state.placement === 'top-start'\n              );\n            },\n          },\n        ],\n      });\n\n      return () => popper.destroy();\n    };\n\n    const optionSelected = (selectedOption) => {\n      state.value = selectedOption.value;\n      props.onSelected(selectedOption);\n\n      nextTick(() => {\n        if (formListItem && formListItem.checkInputed) {\n          formListItem.checkInputed();\n        }\n      });\n    };\n\n    const onUpdate = (val) => {\n      state.value = val;\n      props.onUpdate(val);\n\n      nextTick(() => {\n        if (formListItem && formListItem.checkInputed) {\n          formListItem.checkInputed();\n        }\n      });\n    };\n\n    const OpenIndicator = computed(() => {\n      return {\n        render: () => h(IconDropdown),\n      };\n    });\n\n    onMounted(() => {\n      const { modelValue, defaultValue } = props;\n\n      if (!modelValue && defaultValue) {\n        select.value.setInternalValueFromOptions(defaultValue);\n      }\n\n      if (select.value.selectedValue[0]) {\n        state.value = select.value.selectedValue[0].value;\n\n        nextTick(() => {\n          if (formListItem && formListItem.checkInputed) {\n            formListItem.checkInputed();\n          }\n        });\n      }\n    });\n\n    return {\n      state,\n      select,\n      customClassNames,\n      vmVal,\n      withPopper,\n      optionSelected,\n      OpenIndicator,\n    };\n  },\n};\n</script>\n\n<template>\n  <div :class=\"[$style['select'], customClassNames.wrap]\">\n    <input type=\"hidden\" :value=\"state.value\" />\n    <VueSelect\n      ref=\"select\"\n      v-bind=\"$attrs\"\n      :filterable=\"filterable\"\n      :searchable=\"searchable\"\n      :clearable=\"clearable\"\n      :reduce=\"reduce\"\n      :appendToBody=\"true\"\n      :calculatePosition=\"withPopper\"\n      :components=\"{ OpenIndicator }\"\n      @option:selected=\"optionSelected\"\n      v-model=\"vmVal\"\n    ></VueSelect>\n  </div>\n</template>\n\n<style lang=\"scss\" module>\n@import '@/assets/scss/components/ui/form/BasicSelect.scss';\n</style>\n"],"names":["defaultClassNames","_sfc_main","VueSelect","option","props","emit","$style","useCssModule","state","reactive","formListItem","inject","select","ref","customClassNames","computed","classNames","vmVal","onUpdate","value","withPopper","dropdownList","component","width","popper","createPopper","optionSelected","selectedOption","nextTick","val","OpenIndicator","h","IconDropdown","onMounted","modelValue","defaultValue","_createElementBlock","_normalizeClass","_ctx","$setup","_createElementVNode","_createVNode","_component_VueSelect","_mergeProps","$props","$event"],"mappings":"0RAgBMA,EAAoB,KAAO,CAC/B,KAAM,GACN,KAAM,EACR,GAEKC,EAAU,CACb,WAAY,CACV,UAAAC,CACD,EACD,aAAc,GACd,MAAO,CACL,WAAY,CACV,KAAM,OACN,SAAU,CACR,OAAOF,EAAiB,CACzB,CACF,EACD,WAAY,CACV,KAAM,QACN,QAAS,EACV,EACD,WAAY,CACV,KAAM,QACN,QAAS,EACV,EACD,UAAW,CACT,KAAM,QACN,QAAS,EACV,EACD,OAAQ,CACN,KAAM,SACN,QAAUG,GAAWA,EAAO,KAC7B,EACD,WAAY,CACV,KAAM,SACN,QAAS,IAAM,CAAE,CAClB,EACD,SAAU,CACR,KAAM,SACN,QAAS,IAAM,CAAE,CAClB,EACD,aAAc,CACZ,KAAM,OACN,QAAS,IACV,EACD,WAAY,CACV,KAAM,MACP,CACF,EACD,MAAMC,EAAO,CAAE,KAAAC,GAAQ,CACrB,MAAMC,EAASC,IAETC,EAAQC,EAAS,CACrB,UAAW,eACX,MAAO,EACT,CAAC,EAEKC,EAAeC,EAAO,eAAgB,CAAE,CAAA,EAExCC,EAASC,EAAI,IAAI,EAEjBC,EAAmBC,EAAS,IAAM,CACtC,KAAM,CAAE,WAAAC,CAAW,EAAIZ,EACvB,OAAO,OAAO,OAAOJ,EAAmB,EAAEgB,CAAU,CACtD,CAAC,EAEKC,EAAQF,EAAS,CACrB,KAAM,CACJ,OAAAG,EAASd,EAAM,UAAU,EAClBA,EAAM,UACd,EACD,IAAIe,EAAO,CACTd,EAAK,oBAAqBc,CAAK,CAChC,CACH,CAAC,EAEKC,EAAa,CAACC,EAAcC,EAAW,CAAE,MAAAC,CAAM,IAAM,CACzDF,EAAa,MAAM,MAAQE,EAE3B,MAAMC,EAASC,EAAaH,EAAU,MAAM,OAAQD,EAAc,CAChE,UAAWb,EAAM,UACjB,UAAW,CACT,CACE,KAAM,SACN,QAAS,CACP,OAAQ,CAAC,EAAG,CAAC,CACd,CACF,EACD,CACE,KAAM,cACN,QAAS,GACT,MAAO,QACP,GAAG,CAAE,MAAAA,GAAS,CACZ,KAAM,CAAE,WAAAQ,CAAW,EAAIZ,EACjBU,EAAmB,OAAO,OAC9Bd,EAAmB,EACnBgB,GAGFK,EAAa,UAAU,IAAIf,EAAO,YAAe,EAE7CQ,EAAiB,KAAK,QACxBO,EAAa,UAAU,IAAIP,EAAiB,IAAI,EAGlDO,EAAa,UAAU,OACrB,UACAb,EAAM,YAAc,aAGtBc,EAAU,IAAI,UAAU,OACtB,UACAd,EAAM,YAAc,YAEvB,CACF,CACF,CACH,CAAC,EAED,MAAO,IAAMgB,EAAO,WAGhBE,EAAkBC,GAAmB,CACzCnB,EAAM,MAAQmB,EAAe,MAC7BvB,EAAM,WAAWuB,CAAc,EAE/BC,EAAS,IAAM,CACTlB,GAAgBA,EAAa,cAC/BA,EAAa,aAAY,CAE7B,CAAC,GAGGQ,EAAYW,GAAQ,CACxBrB,EAAM,MAAQqB,EACdzB,EAAM,SAASyB,CAAG,EAElBD,EAAS,IAAM,CACTlB,GAAgBA,EAAa,cAC/BA,EAAa,aAAY,CAE7B,CAAC,GAGGoB,EAAgBf,EAAS,KACtB,CACL,OAAQ,IAAMgB,EAAEC,CAAY,GAE/B,EAED,OAAAC,EAAU,IAAM,CACd,KAAM,CAAE,WAAAC,EAAY,aAAAC,GAAiB/B,EAEjC,CAAC8B,GAAcC,GACjBvB,EAAO,MAAM,4BAA4BuB,CAAY,EAGnDvB,EAAO,MAAM,cAAc,CAAC,IAC9BJ,EAAM,MAAQI,EAAO,MAAM,cAAc,CAAC,EAAE,MAE5CgB,EAAS,IAAM,CACTlB,GAAgBA,EAAa,cAC/BA,EAAa,aAAY,CAE7B,CAAC,EAEL,CAAC,EAEM,CACL,MAAAF,EACA,OAAAI,EACA,iBAAAE,EACA,MAAAG,EACA,WAAAG,EACA,eAAAM,EACA,cAAAI,EAEH,CACH,wEAIEM,EAeM,MAAA,CAfA,MAAQC,EAAA,CAAAC,EAAA,OAAkB,OAAAC,EAAA,iBAAiB,IAAI,CAAA,IACnDC,EAA4C,QAAA,CAArC,KAAK,SAAU,MAAOD,EAAK,MAAC,iBACnCE,EAYaC,EAZbC,EAYa,CAXX,IAAI,UACIL,EAAM,OAAA,CACb,WAAYM,EAAU,WACtB,WAAYA,EAAU,WACtB,UAAWA,EAAS,UACpB,OAAQA,EAAM,OACd,aAAc,GACd,kBAAmBL,EAAU,WAC7B,0BAAcA,EAAa,aAAA,EAC3B,oBAAiBA,EAAc,0BACvBA,EAAK,2CAALA,EAAK,MAAAM"}