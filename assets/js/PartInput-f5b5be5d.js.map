{"version":3,"file":"PartInput-f5b5be5d.js","sources":["../../../../src/components/ui/form/PartInput.vue"],"sourcesContent":["<script>\nimport {\n  ref,\n  computed,\n  onMounted,\n  onUpdated,\n  watch,\n  inject,\n  nextTick,\n  reactive,\n} from 'vue';\n\nconst defaultClassNames = () => ({\n  wrap: '',\n  block: '',\n  input: '',\n  dot: '',\n  placeholderDot: '',\n  placeholderDotItem: '',\n  placeholderDotItemHide: '',\n});\n\nexport default {\n  inheritAttrs: false,\n  props: {\n    classNames: {\n      Type: Object,\n      default() {\n        return defaultClassNames();\n      },\n    },\n    type: {\n      Type: String,\n      default: 'text',\n    },\n    length: {\n      Type: Number,\n      default: 1,\n    },\n    beforeDot: {\n      Type: Number,\n      default: 0,\n    },\n    afterDot: {\n      Type: Number,\n      default: 0,\n    },\n    defaultValue: {\n      Type: String,\n      default: null,\n    },\n    modelValue: {\n      Type: String,\n    },\n    disabled: {\n      Type: Boolean,\n      default: false,\n    },\n    placeholderDot: {\n      Type: Boolean,\n      default: false,\n    },\n  },\n  setup(props, { emit }) {\n    const formListItem = inject('formListItem', {});\n\n    const state = reactive({\n      valueLength: 0,\n      value: null,\n    });\n\n    const input = ref(null);\n\n    const customClassNames = computed(() => {\n      const { classNames } = props;\n      return Object.assign(defaultClassNames(), classNames);\n    });\n\n    const value = computed(() => {\n      const { modelValue, defaultValue } = props;\n      const { value } = state;\n\n      return typeof modelValue === 'string'\n        ? modelValue\n        : typeof value === 'string'\n        ? value\n        : defaultValue;\n    });\n\n    const checkLength = () => {\n      const { length } = props;\n      const val = input.value.value;\n\n      if (val.length > length) {\n        input.value.value = val.substr(0, length);\n\n        const eInput = new Event('input');\n        input.value.dispatchEvent(eInput);\n      }\n    };\n\n    const onInput = (e) => {\n      const val = e.target.value;\n\n      state.value = val;\n      state.valueLength = val.length;\n\n      emit('update:modelValue', val);\n    };\n\n    onMounted(() => {\n      if (typeof value.value === 'string') {\n        state.value = value.value;\n        state.valueLength = value.value.length;\n      }\n\n      checkLength();\n    });\n\n    onUpdated(() => {\n      if (input.value) {\n        const val = input.value.value;\n\n        state.value = val;\n        state.valueLength = val.length;\n      }\n\n      checkLength();\n    });\n\n    watch(\n      () => props.modelValue,\n      (cur) => {\n        state.value = cur;\n        state.valueLength = cur.length;\n\n        checkLength();\n\n        nextTick(() => {\n          if (formListItem && formListItem.checkInputed) {\n            formListItem.checkInputed();\n          }\n        });\n      }\n    );\n\n    return {\n      state,\n      input,\n      customClassNames,\n      value,\n      checkLength,\n      onInput,\n    };\n  },\n};\n</script>\n\n<template>\n  <div\n    :class=\"[\n      $style['part-input'],\n      {\n        [$style['part-input--disabled']]: disabled,\n      },\n      customClassNames.wrap,\n    ]\"\n  >\n    <div\n      v-for=\"item in beforeDot\"\n      :key=\"item\"\n      :class=\"[$style['part-input__dot'], customClassNames.dot]\"\n    />\n    <div\n      :class=\"[$style['part-input__block'], customClassNames.block]\"\n      :style=\"`width: ${22 * length}px;`\"\n    >\n      <div\n        v-if=\"placeholderDot\"\n        :class=\"[\n          $style['part-input__placeholder-dot'],\n          customClassNames.placeholderDot,\n        ]\"\n      >\n        <div\n          v-for=\"item in length\"\n          :key=\"item\"\n          :class=\"[\n            $style['part-input__placeholder-dot-item'],\n            customClassNames.placeholderDotItem,\n            {\n              [$style['part-input__placeholder-dot-item--hide']]:\n                item <= state.valueLength,\n              [customClassNames.placeholderDotItemHide]:\n                item <= state.valueLength,\n            },\n          ]\"\n        />\n      </div>\n      <input\n        ref=\"input\"\n        v-bind=\"$attrs\"\n        :type=\"type\"\n        :class=\"[$style['part-input__input'], customClassNames.input]\"\n        :maxlength=\"length\"\n        :value=\"value\"\n        :disabled=\"disabled\"\n        @input=\"onInput\"\n        @focusin=\"checkLength\"\n        @focusout=\"checkLength\"\n        @keydown=\"checkLength\"\n        @keyup=\"checkLength\"\n      />\n    </div>\n    <div\n      v-for=\"item in afterDot\"\n      :key=\"item\"\n      :class=\"[$style['part-input__dot'], customClassNames.dot]\"\n    />\n  </div>\n</template>\n\n<style lang=\"scss\" module>\n@import '@/assets/scss/components/ui/form/PartInput.scss';\n</style>\n"],"names":["defaultClassNames","_sfc_main","props","emit","formListItem","inject","state","reactive","input","ref","customClassNames","computed","classNames","value","modelValue","defaultValue","checkLength","length","val","eInput","onInput","e","onMounted","onUpdated","watch","cur","nextTick","_createElementBlock","_normalizeClass","_ctx","$props","$setup","_Fragment","_renderList","item","_createElementVNode","_mergeProps","args"],"mappings":"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"}